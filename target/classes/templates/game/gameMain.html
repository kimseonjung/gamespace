<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="setContent(content)">
<head>
    <meta charset="UTF-8">

    <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/common.css">



    <title>gamespace</title>



    <!-- jQuery library -->
<!--    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>-->

    <!-- Popper JS-->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

</head>
<body>

<div id="game">
    <th:block th:replace="~{common/header :: header}"/>
</div>



<!--th:text="${category.categoryName}"-->
<!--th:field="*{category}"-->
<!--th:for="${#ids.prev(categoryList)}"-->
<!--th:value="${category.categoryCode}"-->
    <section>
        <form action="/game/game"  method="post" onsubmit="return false;" id="category">

            <div th:each="category : ${categoryList}" id="categoryCode">
                <input th:text="${category.categoryName}" th:value="${category.categoryCode}" th:type="checkbox" name="categoryCode" class="category">

            </div>


            <div th:each="tag : ${tagList}" id="tagCode">
                <input th:text="${tag.tagName}" th:value="${tag.tagCode}" th:type="checkbox" name="tagCode" class="tag">
            </div>


            <div th:each="devices : ${devicesList}">
                <button th:text="${devices.devicesName}"></button>

            </div>
            <input type="submit" onclick="searchGameMainList()">전송</input>
        </form>

<!--            <div class="toggle" >-->
<!--                <form th:action="@{game}" method="get">-->
<!--                    <label for="pc"><input type="radio" name="category" id="pc" class="category" checked th:value="${devicesOne.devicesCode}"><div class="togg pc"><img src="/image/icon_dark/pc.svg" alt=""></div></label>-->
<!--                </form>-->
<!--                <form th:action="@{game}" method="get">-->
<!--                    <label for="mobile"><input type="radio" name="category" id="mobile" class="category" th:value="${devicesOne.devicesCode}"><div class="togg mobile"><img src="/image/icon_dark/mobile.svg" alt=""></div></label>-->
<!--                </form>-->
<!--                <form th:action="@{game}" method="get">-->
<!--                    <label for="console"><input type="radio" name="category" id="console" class="category" th:value="${devicesOne.devicesCode}"><div class="togg console"><img src="/image/icon_dark/console.svg" alt=""></div></label>-->
<!--                </form>-->
<!--            </div>-->

    </section>


    <section>

<!--        <div th:each="game : ${gameInfoList}"> &lt;!&ndash;th:class="t-body"&ndash;&gt;-->
<!--            <div th:text="${game.gameName}"></div>-->
<!--            <div th:text="${game.categoryCode}"></div>-->
<!--            <div th:text="${game.tagCode}"></div>-->
<!--            <div th:text="${game.gameIntro}"></div>-->
<!--        </div>-->

        <div th:id="search">
<!--            <div id="game-title"> </div>-->
<!--            <div id="game-body"> </div>-->

        </div>



    </section>










<div class="footer">
    <th:block th:replace="~{common/footer :: footer}"/>
</div>

<script>

   function searchGameMainList() {

       const categoryCode = [];
       categoryCode.push('tmp');
       $("input[name='categoryCode']:checked").each(function (){
           let chk = $(this).val();
           categoryCode.push(chk);
       });

       const tagCode = [];
       tagCode.push('tmp');
       $("input[name='tagCode']:checked").each(function (){
           let thk = $(this).val();
           tagCode.push(thk);
       });


       console.log(categoryCode);
       console.log(tagCode);

       $.ajax({
           url: "/game/game",             // 요청할 서버url
           type : "post", // 타입은 뭘 쓸거니?
           datatype : "json",
           data: {
               categoryCode : categoryCode,
               tagCode : tagCode
           },

           success: function(data,status, xhr) {    // 결과 성공 콜백함수

               console.log(data.categoryList[0].gameName);


               $('#search').html("");

               data.categoryList.forEach(function(item) {
                   let table = "<tr>";
                   table += "<td>"+item.gameName+"</td>";
                   table += "<td>"+item.categoryCode+"</td>";
                   table += "<td>"+item.tagCode+"</td>";
                   table += "<td>"+item.gameIntro+"</td>";
                   table += "</tr>";
                   $('#search').append(table);
               });


           },
           error: function(xhr, status, error) {   // 결과 에러 콜백함수
               console.log('error');
           }
       });
   };






</script>

</body>
</th:block>
</html>